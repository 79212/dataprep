
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>dataprep.tests.eda.test_plot &#8212; dataprep 0.0.1 documentation</title>
    <link rel="stylesheet" href="../../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">dataprep 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for dataprep.tests.eda.test_plot</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    module for testing plot(df, x, y) function.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">Timestamp</span>
<span class="kn">from</span> <span class="nn">...eda.common</span> <span class="k">import</span> <span class="n">Intermediate</span>
<span class="kn">from</span> <span class="nn">...eda</span> <span class="k">import</span> <span class="n">plot</span>

<span class="n">LOGGER</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="test_normal_1"><a class="viewcode-back" href="../../../../dataprep.tests.eda.html#dataprep.tests.eda.test_plot.test_normal_1">[docs]</a><span class="k">def</span> <span class="nf">test_normal_1</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TEST - 1 for plot(df)</span>
    <span class="n">data_1</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="mi">97</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)],</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.000001</span><span class="p">,</span> <span class="mf">654.152</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">15.984512</span><span class="p">,</span> <span class="mi">3122</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.1415926535</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mf">15.9</span><span class="p">,</span> <span class="mf">13.5</span><span class="p">],</span>
        <span class="s2">&quot;s1&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
        <span class="s2">&quot;somedate&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">57</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1898</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="s2">&quot;bool_tf&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
        <span class="s2">&quot;bool_tf_with_nan&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="kc">True</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="kc">True</span><span class="p">,</span>
            <span class="kc">True</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;bool_01&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;bool_01_with_nan&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
        <span class="s2">&quot;mixed&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="n">df_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_1</span><span class="p">)</span>

    <span class="n">df_1_expected</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;bool_01&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;bar_plot&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="s2">&quot;missing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]},</span>
        <span class="s2">&quot;bool_01_with_nan&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;bar_plot&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="s2">&quot;missing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]},</span>
        <span class="s2">&quot;bool_tf&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;bar_plot&quot;</span><span class="p">:</span> <span class="p">{</span><span class="kc">False</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span> <span class="s2">&quot;missing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]},</span>
        <span class="s2">&quot;bool_tf_with_nan&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;bar_plot&quot;</span><span class="p">:</span> <span class="p">{</span><span class="kc">False</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="s2">&quot;missing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]},</span>
        <span class="s2">&quot;s1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;bar_plot&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mf">1.0</span><span class="p">:</span> <span class="mi">9</span><span class="p">},</span> <span class="s2">&quot;missing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]},</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;histogram&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">14.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">26.0</span><span class="p">,</span> <span class="mf">32.0</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="mf">44.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">]</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="s2">&quot;missing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;histogram&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="o">-</span><span class="mf">3.14</span><span class="p">,</span>
                        <span class="mf">309.37</span><span class="p">,</span>
                        <span class="mf">621.89</span><span class="p">,</span>
                        <span class="mf">934.4</span><span class="p">,</span>
                        <span class="mf">1246.92</span><span class="p">,</span>
                        <span class="mf">1559.43</span><span class="p">,</span>
                        <span class="mf">1871.94</span><span class="p">,</span>
                        <span class="mf">2184.46</span><span class="p">,</span>
                        <span class="mf">2496.97</span><span class="p">,</span>
                        <span class="mf">2809.49</span><span class="p">,</span>
                        <span class="mf">3122.0</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="s2">&quot;missing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="n">returned_1</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Intermediate</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span>
        <span class="n">df_1</span><span class="p">,</span> <span class="n">force_cat</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bool_01&quot;</span><span class="p">,</span> <span class="s2">&quot;bool_01_with_nan&quot;</span><span class="p">,</span> <span class="s2">&quot;s1&quot;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># TESTING</span>
    <span class="k">for</span> <span class="n">intermediate</span> <span class="ow">in</span> <span class="n">returned_1</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">intermediate</span><span class="o">.</span><span class="n">result</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">intermediate</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="s2">&quot;col_x&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">df_1_expected</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Testing </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;histogram&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
                    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;histogram&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">df_1_expected</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="s2">&quot;histogram&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">equal_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
                    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;histogram&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">df_1_expected</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="s2">&quot;histogram&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">equal_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="n">df_1_expected</span><span class="p">[</span><span class="n">intermediate</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="s2">&quot;col_x&quot;</span><span class="p">]]</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;....Checked&quot;</span><span class="p">)</span>

    <span class="c1"># TEST - 2 for plot(df, x, y)</span>
    <span class="n">data_2</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="mi">97</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)],</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;d&quot;</span><span class="p">,</span>
            <span class="s2">&quot;c&quot;</span><span class="p">,</span>
            <span class="s2">&quot;b&quot;</span><span class="p">,</span>
            <span class="s2">&quot;a&quot;</span><span class="p">,</span>
            <span class="s2">&quot;b&quot;</span><span class="p">,</span>
            <span class="s2">&quot;d&quot;</span><span class="p">,</span>
            <span class="s2">&quot;c&quot;</span><span class="p">,</span>
            <span class="s2">&quot;a&quot;</span><span class="p">,</span>
            <span class="s2">&quot;a&quot;</span><span class="p">,</span>
            <span class="s2">&quot;a&quot;</span><span class="p">,</span>
            <span class="s2">&quot;c&quot;</span><span class="p">,</span>
            <span class="s2">&quot;b&quot;</span><span class="p">,</span>
            <span class="s2">&quot;c&quot;</span><span class="p">,</span>
            <span class="s2">&quot;a&quot;</span><span class="p">,</span>
            <span class="s2">&quot;d&quot;</span><span class="p">,</span>
            <span class="s2">&quot;b&quot;</span><span class="p">,</span>
            <span class="s2">&quot;b&quot;</span><span class="p">,</span>
            <span class="s2">&quot;b&quot;</span><span class="p">,</span>
            <span class="s2">&quot;b&quot;</span><span class="p">,</span>
            <span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="mi">794</span><span class="p">,</span>
            <span class="mi">652</span><span class="p">,</span>
            <span class="mi">158</span><span class="p">,</span>
            <span class="mi">134</span><span class="p">,</span>
            <span class="mi">448</span><span class="p">,</span>
            <span class="mi">682</span><span class="p">,</span>
            <span class="mi">135</span><span class="p">,</span>
            <span class="mi">795</span><span class="p">,</span>
            <span class="mi">353</span><span class="p">,</span>
            <span class="mi">395</span><span class="p">,</span>
            <span class="mi">403</span><span class="p">,</span>
            <span class="mi">498</span><span class="p">,</span>
            <span class="mi">622</span><span class="p">,</span>
            <span class="mi">80</span><span class="p">,</span>
            <span class="mi">654</span><span class="p">,</span>
            <span class="mi">772</span><span class="p">,</span>
            <span class="mi">867</span><span class="p">,</span>
            <span class="mi">676</span><span class="p">,</span>
            <span class="mi">670</span><span class="p">,</span>
            <span class="mi">736</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;s1&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
        <span class="s2">&quot;somedate&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1898</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1898</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1898</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
        <span class="p">],</span>
    <span class="p">}</span>

    <span class="n">df_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_2</span><span class="p">)</span>

    <span class="n">df_2_expected</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;box_plot&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;tf&quot;</span><span class="p">:</span> <span class="mf">134.0</span><span class="p">,</span>
                <span class="s2">&quot;fy&quot;</span><span class="p">:</span> <span class="mf">353.0</span><span class="p">,</span>
                <span class="s2">&quot;sf&quot;</span><span class="p">:</span> <span class="mf">395.0</span><span class="p">,</span>
                <span class="s2">&quot;iqr&quot;</span><span class="p">:</span> <span class="mf">261.0</span><span class="p">,</span>
                <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">395</span><span class="p">,</span>
                <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
                <span class="s2">&quot;max_outlier&quot;</span><span class="p">:</span> <span class="mi">795</span><span class="p">,</span>
                <span class="s2">&quot;outliers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">795</span><span class="p">],</span>
                <span class="s2">&quot;lw&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
                <span class="s2">&quot;uw&quot;</span><span class="p">:</span> <span class="mi">395</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;tf&quot;</span><span class="p">:</span> <span class="mf">473.0</span><span class="p">,</span>
                <span class="s2">&quot;fy&quot;</span><span class="p">:</span> <span class="mf">673.0</span><span class="p">,</span>
                <span class="s2">&quot;sf&quot;</span><span class="p">:</span> <span class="mf">754.0</span><span class="p">,</span>
                <span class="s2">&quot;iqr&quot;</span><span class="p">:</span> <span class="mf">281.0</span><span class="p">,</span>
                <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">867</span><span class="p">,</span>
                <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">158</span><span class="p">,</span>
                <span class="s2">&quot;max_outlier&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
                <span class="s2">&quot;outliers&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="s2">&quot;lw&quot;</span><span class="p">:</span> <span class="mi">158</span><span class="p">,</span>
                <span class="s2">&quot;uw&quot;</span><span class="p">:</span> <span class="mi">867</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;tf&quot;</span><span class="p">:</span> <span class="mf">269.0</span><span class="p">,</span>
                <span class="s2">&quot;fy&quot;</span><span class="p">:</span> <span class="mf">512.5</span><span class="p">,</span>
                <span class="s2">&quot;sf&quot;</span><span class="p">:</span> <span class="mf">637.0</span><span class="p">,</span>
                <span class="s2">&quot;iqr&quot;</span><span class="p">:</span> <span class="mf">368.0</span><span class="p">,</span>
                <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">652</span><span class="p">,</span>
                <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">135</span><span class="p">,</span>
                <span class="s2">&quot;max_outlier&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
                <span class="s2">&quot;outliers&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="s2">&quot;lw&quot;</span><span class="p">:</span> <span class="mi">135</span><span class="p">,</span>
                <span class="s2">&quot;uw&quot;</span><span class="p">:</span> <span class="mi">652</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;tf&quot;</span><span class="p">:</span> <span class="mf">668.0</span><span class="p">,</span>
                <span class="s2">&quot;fy&quot;</span><span class="p">:</span> <span class="mf">682.0</span><span class="p">,</span>
                <span class="s2">&quot;sf&quot;</span><span class="p">:</span> <span class="mf">738.0</span><span class="p">,</span>
                <span class="s2">&quot;iqr&quot;</span><span class="p">:</span> <span class="mf">70.0</span><span class="p">,</span>
                <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">794</span><span class="p">,</span>
                <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">654</span><span class="p">,</span>
                <span class="s2">&quot;max_outlier&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
                <span class="s2">&quot;outliers&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="s2">&quot;lw&quot;</span><span class="p">:</span> <span class="mi">654</span><span class="p">,</span>
                <span class="s2">&quot;uw&quot;</span><span class="p">:</span> <span class="mi">794</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="s2">&quot;histogram&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="mf">654.0</span><span class="p">,</span>
                        <span class="mf">668.0</span><span class="p">,</span>
                        <span class="mf">682.0</span><span class="p">,</span>
                        <span class="mf">696.0</span><span class="p">,</span>
                        <span class="mf">710.0</span><span class="p">,</span>
                        <span class="mf">724.0</span><span class="p">,</span>
                        <span class="mf">738.0</span><span class="p">,</span>
                        <span class="mf">752.0</span><span class="p">,</span>
                        <span class="mf">766.0</span><span class="p">,</span>
                        <span class="mf">780.0</span><span class="p">,</span>
                        <span class="mf">794.0</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="mf">135.0</span><span class="p">,</span>
                        <span class="mf">186.7</span><span class="p">,</span>
                        <span class="mf">238.4</span><span class="p">,</span>
                        <span class="mf">290.1</span><span class="p">,</span>
                        <span class="mf">341.8</span><span class="p">,</span>
                        <span class="mf">393.5</span><span class="p">,</span>
                        <span class="mf">445.2</span><span class="p">,</span>
                        <span class="mf">496.9</span><span class="p">,</span>
                        <span class="mf">548.6</span><span class="p">,</span>
                        <span class="mf">600.3</span><span class="p">,</span>
                        <span class="mf">652.0</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="mf">158.0</span><span class="p">,</span>
                        <span class="mf">228.9</span><span class="p">,</span>
                        <span class="mf">299.8</span><span class="p">,</span>
                        <span class="mf">370.7</span><span class="p">,</span>
                        <span class="mf">441.6</span><span class="p">,</span>
                        <span class="mf">512.5</span><span class="p">,</span>
                        <span class="mf">583.4</span><span class="p">,</span>
                        <span class="mf">654.3</span><span class="p">,</span>
                        <span class="mf">725.2</span><span class="p">,</span>
                        <span class="mf">796.1</span><span class="p">,</span>
                        <span class="mf">867.0</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="mf">80.0</span><span class="p">,</span>
                        <span class="mf">151.5</span><span class="p">,</span>
                        <span class="mf">223.0</span><span class="p">,</span>
                        <span class="mf">294.5</span><span class="p">,</span>
                        <span class="mf">366.0</span><span class="p">,</span>
                        <span class="mf">437.5</span><span class="p">,</span>
                        <span class="mf">509.0</span><span class="p">,</span>
                        <span class="mf">580.5</span><span class="p">,</span>
                        <span class="mf">652.0</span><span class="p">,</span>
                        <span class="mf">723.5</span><span class="p">,</span>
                        <span class="mf">795.0</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">),</span>
            <span class="p">),</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="n">returned_2</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Intermediate</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">df_2</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>

    <span class="c1"># TESTING</span>
    <span class="k">for</span> <span class="n">intermediate</span> <span class="ow">in</span> <span class="n">returned_2</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">intermediate</span><span class="o">.</span><span class="n">result</span>
        <span class="n">field_x</span> <span class="o">=</span> <span class="n">intermediate</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="s2">&quot;col_x&quot;</span><span class="p">]</span>
        <span class="n">field_y</span> <span class="o">=</span> <span class="n">intermediate</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="s2">&quot;col_y&quot;</span><span class="p">]</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Testing </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">field_x</span><span class="p">,</span> <span class="n">field_y</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;box_plot&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;box_plot&quot;</span><span class="p">][</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df_2_expected</span><span class="p">[</span><span class="s2">&quot;box_plot&quot;</span><span class="p">][</span><span class="s2">&quot;a&quot;</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;box_plot&quot;</span><span class="p">][</span><span class="s2">&quot;b&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df_2_expected</span><span class="p">[</span><span class="s2">&quot;box_plot&quot;</span><span class="p">][</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;box_plot&quot;</span><span class="p">][</span><span class="s2">&quot;c&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df_2_expected</span><span class="p">[</span><span class="s2">&quot;box_plot&quot;</span><span class="p">][</span><span class="s2">&quot;c&quot;</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;box_plot&quot;</span><span class="p">][</span><span class="s2">&quot;d&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df_2_expected</span><span class="p">[</span><span class="s2">&quot;box_plot&quot;</span><span class="p">][</span><span class="s2">&quot;d&quot;</span><span class="p">]</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;....Checked.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">&quot;histogram&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
                <span class="n">result</span><span class="p">[</span><span class="s2">&quot;histogram&quot;</span><span class="p">][</span><span class="s2">&quot;a&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">df_2_expected</span><span class="p">[</span><span class="s2">&quot;histogram&quot;</span><span class="p">][</span><span class="s2">&quot;a&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">equal_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
                <span class="n">result</span><span class="p">[</span><span class="s2">&quot;histogram&quot;</span><span class="p">][</span><span class="s2">&quot;b&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">df_2_expected</span><span class="p">[</span><span class="s2">&quot;histogram&quot;</span><span class="p">][</span><span class="s2">&quot;b&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">equal_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
                <span class="n">result</span><span class="p">[</span><span class="s2">&quot;histogram&quot;</span><span class="p">][</span><span class="s2">&quot;c&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">df_2_expected</span><span class="p">[</span><span class="s2">&quot;histogram&quot;</span><span class="p">][</span><span class="s2">&quot;c&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">equal_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
                <span class="n">result</span><span class="p">[</span><span class="s2">&quot;histogram&quot;</span><span class="p">][</span><span class="s2">&quot;d&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">df_2_expected</span><span class="p">[</span><span class="s2">&quot;histogram&quot;</span><span class="p">][</span><span class="s2">&quot;d&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">equal_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;....Checked.&quot;</span><span class="p">)</span>

    <span class="c1"># TEST - 3 for plot(df, x, y)</span>
    <span class="n">df_2_expected_2</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;stacked_column_plot&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1898-01-02 00:00:00&quot;</span><span class="p">)):</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1950-12-09 00:00:00&quot;</span><span class="p">)):</span> <span class="mi">3</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1990-12-09 00:00:00&quot;</span><span class="p">)):</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1898-01-02 00:00:00&quot;</span><span class="p">)):</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1950-12-09 00:00:00&quot;</span><span class="p">)):</span> <span class="mi">7</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1898-01-02 00:00:00&quot;</span><span class="p">)):</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1950-12-09 00:00:00&quot;</span><span class="p">)):</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1950-12-09 00:00:00&quot;</span><span class="p">)):</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1990-12-09 00:00:00&quot;</span><span class="p">)):</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2011-07-04 00:00:00&quot;</span><span class="p">)):</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">returned_3</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Intermediate</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">df_2</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;somedate&quot;</span><span class="p">)</span>

    <span class="c1"># TESTING</span>
    <span class="k">for</span> <span class="n">intermediate</span> <span class="ow">in</span> <span class="n">returned_3</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">intermediate</span><span class="o">.</span><span class="n">result</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Testing </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">intermediate</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="s2">&quot;col_x&quot;</span><span class="p">],</span>
            <span class="n">intermediate</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="s2">&quot;col_y&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;stacked_column_plot&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="n">df_2_expected_2</span><span class="p">[</span><span class="s2">&quot;stacked_column_plot&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;stacked_column_plot&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;.....Checked.&quot;</span><span class="p">)</span></div>


<span class="c1"># def test_normal_2() -&gt; None:</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     test normal 2</span>
<span class="c1">#     :return:</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     # TEST - 4 for plot(df, x)</span>
<span class="c1">#     data_3 = {&quot;num_col&quot;: np.random.rand(10), &quot;cat_col&quot;: [random.choice([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;])</span>
<span class="c1">#                                                          for _ in range(10)]}</span>
<span class="c1">#     df_3 = pd.DataFrame(data_3)</span>

<span class="c1">#     returned_4: List[Intermediate] = plot(df_3, &quot;num_col&quot;)</span>

<span class="c1">#     mat_box = plt.boxplot(df_3[&quot;num_col&quot;])</span>
<span class="c1">#     df_3_expected = {&quot;qqnorm_plot&quot;: {&quot;sample&quot;: sm.probplot(df_3[&quot;num_col&quot;])[0][0],</span>
<span class="c1">#                                      &quot;theory&quot;: sm.probplot(df_3[&quot;num_col&quot;])[0][1]},</span>
<span class="c1">#                      &quot;histogram&quot;: np.histogram(df_3[&quot;num_col&quot;]),</span>
<span class="c1">#                      &quot;box_plot&quot;: {&quot;tf&quot;: mat_box[&quot;boxes&quot;][0].get_xydata()[0][1],</span>
<span class="c1">#                                   &quot;sf&quot;: mat_box[&quot;boxes&quot;][0].get_xydata()[2][1],</span>
<span class="c1">#                                   &quot;fy&quot;: mat_box[&quot;medians&quot;][0].get_xydata()[0][1],</span>
<span class="c1">#                                   &quot;outliers&quot;: list(mat_box[&quot;fliers&quot;][0].get_xydata()[:, 1])},</span>
<span class="c1">#                      &quot;bar_plot&quot;: dict(df_3.groupby([&quot;cat_col&quot;])[&quot;cat_col&quot;].count())</span>
<span class="c1">#                      }</span>

<span class="c1">#     for intermediate in returned_4:</span>
<span class="c1">#         result = intermediate.result</span>
<span class="c1">#         col_x = intermediate.raw_data[&quot;col_x&quot;]</span>
<span class="c1">#         LOGGER.info(&quot;Testing %s&quot;, intermediate.raw_data[&quot;col_x&quot;])</span>
<span class="c1">#         if &quot;qqnorm_plot&quot; in result:</span>
<span class="c1">#             assert np.allclose(result[&quot;qqnorm_plot&quot;][&quot;sample&quot;],</span>
<span class="c1">#                                df_3_expected[&quot;qqnorm_plot&quot;][&quot;sample&quot;], 0.1, 0.1)</span>
<span class="c1">#             assert np.allclose(result[&quot;qqnorm_plot&quot;][&quot;theory&quot;],</span>
<span class="c1">#                                df_3_expected[&quot;qqnorm_plot&quot;][&quot;theory&quot;], 0.1, 0.1)</span>
<span class="c1">#             LOGGER.info(&quot;.....Checked.&quot;)</span>
<span class="c1">#         elif &quot;histogram&quot; in result:</span>
<span class="c1">#             assert np.allclose(result[&quot;histogram&quot;][0], df_3_expected[&quot;histogram&quot;][0], 0.1, 0.1)</span>
<span class="c1">#             assert np.allclose(result[&quot;histogram&quot;][1], df_3_expected[&quot;histogram&quot;][1], 0.1, 0.1)</span>
<span class="c1">#             LOGGER.info(&quot;.....Checked.&quot;)</span>
<span class="c1">#         elif &quot;box_plot&quot; in result:</span>
<span class="c1">#             assert np.isclose(result[&quot;box_plot&quot;][col_x][&quot;tf&quot;],</span>
<span class="c1">#                               np.round(df_3_expected[&quot;box_plot&quot;][&quot;tf&quot;], 2), 0.1, 0.1)</span>
<span class="c1">#             assert np.isclose(result[&quot;box_plot&quot;][col_x][&quot;fy&quot;],</span>
<span class="c1">#                               np.round(df_3_expected[&quot;box_plot&quot;][&quot;fy&quot;], 2), 0.1, 0.1)</span>
<span class="c1">#             assert np.isclose(result[&quot;box_plot&quot;][col_x][&quot;sf&quot;],</span>
<span class="c1">#                               np.round(df_3_expected[&quot;box_plot&quot;][&quot;sf&quot;], 2), 0.1, 0.1)</span>
<span class="c1">#             assert np.allclose(result[&quot;box_plot&quot;][col_x][&quot;outliers&quot;],</span>
<span class="c1">#                                df_3_expected[&quot;box_plot&quot;][&quot;outliers&quot;], 0.1, 0.1)</span>
<span class="c1">#             LOGGER.info(&quot;.....Checked.&quot;)</span>
<span class="c1">#         elif &quot;bar_plot&quot; in result:</span>
<span class="c1">#             assert result[&quot;bar_plot&quot;] == df_3_expected[&quot;bar_plot&quot;]</span>
<span class="c1">#             LOGGER.info(&quot;.....Checked.&quot;)</span>


<span class="c1"># def test_corner() -&gt; None:</span>
<span class="c1">#     &quot;&quot;&quot;</span>

<span class="c1">#     :return:</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     df_2 = pd.DataFrame(</span>
<span class="c1">#         {&quot;all_nan&quot;: [np.nan for _ in range(10)], &quot;all_one&quot;: np.ones(10),</span>
<span class="c1">#          &quot;all_zeros&quot;: np.zeros(10), &quot;random&quot;: np.array(</span>
<span class="c1">#              [0.38538395, 0.13609054, 0.15973238, 0.96192966, 0.03708882,</span>
<span class="c1">#               0.03633855, 0.25260128, 0.72139843, 0.74553949,</span>
<span class="c1">#               0.41102021])})</span>

<span class="c1">#     df_1_expected = {&quot;all_one&quot;: {&quot;bar_plot&quot;: {1.0: 10}},</span>
<span class="c1">#                      &quot;all_zeros&quot;: {&quot;bar_plot&quot;: {0.0: 10}},</span>
<span class="c1">#                      &quot;random&quot;: {&quot;bar_plot&quot;: np.array([2, 2, 1, 1, 1, 0, 0, 2, 0, 1],</span>
<span class="c1">#                                                      dtype=np.int64)}}</span>

<span class="c1">#     res = plot(df_2, force_cat=[&quot;all_one&quot;, &quot;all_zeros&quot;])</span>

<span class="c1">#     assert res[&quot;all_one&quot;] == df_1_expected[&quot;all_one&quot;]</span>
<span class="c1">#     assert res[&quot;all_zeros&quot;] == df_1_expected[&quot;all_zeros&quot;]</span>

<span class="c1">#     df_2 = pd.DataFrame({</span>
<span class="c1">#         &quot;empty&quot;: [],</span>
<span class="c1">#         &quot;another_empty&quot;: []</span>
<span class="c1">#     })</span>

<span class="c1">#     df_2_expected: Dict[str, Any] = {&#39;scatter_plot&#39;: {}}</span>

<span class="c1">#     res = plot(df_2, &quot;empty&quot;, &quot;another_empty&quot;)</span>
<span class="c1">#     assert res == df_2_expected</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">dataprep 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, SFU Database System Lab.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>